 @model IEnumerable<CommonData.Models.Employee>

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .btn-custom {
        background-color: #5c85d6;
        color: #ffffff; 
        border-radius: 4px; 
        padding: 0.375rem 0.75rem; 
        border: none; 
        transition: background-color 0.2s;
    }

        .btn-custom:hover {
            background-color: #4a6bb1; 
        }
</style>


@if (User.IsInRole("Manager"))
{
    <h1>Index</h1>

    <p>
        <a asp-action="Create" class="btn btn-success">Create New</a>
    </p>
    <div class="table-responsive" style="overflow-x: auto;">
        <table class="table table-striped table-bordered table-hover">
            <thead>
                <tr>
                    <th>@Html.DisplayNameFor(model => model.LastName)</th>
                    <th>@Html.DisplayNameFor(model => model.FirstName)</th>
                    <th>@Html.DisplayNameFor(model => model.Title)</th>
                    <th class="d-none d-lg-table-cell">@Html.DisplayNameFor(model => model.TitleOfCourtesy)</th>
                    <th class="d-none d-lg-table-cell">@Html.DisplayNameFor(model => model.BirthDate)</th>
                    <th class="d-none d-lg-table-cell">@Html.DisplayNameFor(model => model.HireDate)</th>
                    <th class="d-none d-xl-table-cell">@Html.DisplayNameFor(model => model.Address)</th>
                    <th>@Html.DisplayNameFor(model => model.City)</th>
                    <th class="d-none d-md-table-cell">@Html.DisplayNameFor(model => model.Region)</th>
                    <th class="d-none d-md-table-cell">@Html.DisplayNameFor(model => model.PostalCode)</th>
                    <th>@Html.DisplayNameFor(model => model.Country)</th>
                    <th class="d-none d-sm-table-cell">@Html.DisplayNameFor(model => model.HomePhone)</th>
                    <th class="d-none d-lg-table-cell">@Html.DisplayNameFor(model => model.Extension)</th>
                    <th>@Html.DisplayNameFor(model => model.Photo)</th>
                    <th class="d-none d-xl-table-cell">@Html.DisplayNameFor(model => model.Notes)</th>
                    <th class="d-none d-lg-table-cell">@Html.DisplayNameFor(model => model.ReportsToNavigation)</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr class="text-center">
                        <td >@Html.DisplayFor(modelItem => item.LastName)</td>
                        <td>@Html.DisplayFor(modelItem => item.FirstName)</td>
                        <td>@Html.DisplayFor(modelItem => item.Title)</td>
                        <td class="d-none d-lg-table-cell">@Html.DisplayFor(modelItem => item.TitleOfCourtesy)</td>
                        <td class="d-none d-lg-table-cell">@Html.DisplayFor(modelItem => item.BirthDate)</td>
                        <td class="d-none d-lg-table-cell">@Html.DisplayFor(modelItem => item.HireDate)</td>
                        <td class="d-none d-xl-table-cell">@Html.DisplayFor(modelItem => item.Address)</td>
                        <td>@Html.DisplayFor(modelItem => item.City)</td>
                        <td class="d-none d-md-table-cell">@Html.DisplayFor(modelItem => item.Region)</td>
                        <td class="d-none d-md-table-cell">@Html.DisplayFor(modelItem => item.PostalCode)</td>
                        <td>@Html.DisplayFor(modelItem => item.Country)</td>
                        <td class="d-none d-sm-table-cell">@Html.DisplayFor(modelItem => item.HomePhone)</td>
                        <td class="d-none d-lg-table-cell">@Html.DisplayFor(modelItem => item.Extension)</td>
                        <td>
                            @if (item.Photo != null)
                            {
                                <img src="@Url.Action("GetEmployeePhoto", "Employees", new { id = item.EmployeeId })"
                                     alt="Employee Photo"
                                     class="img-thumbnail"
                                     style="width: 50px; height: 50px; cursor: pointer;"
                                     data-toggle="modal"
                                     data-target="#photoModal_@item.EmployeeId">
                            }
                        </td>
                    
                        <td>
                            <button onclick="toggleNotesVisibility(@item.EmployeeId)" class="btn btn-custom btn-sm" >View Notes</button>

                            <div id="notes-@item.EmployeeId" style="display:none;">
                                @Html.DisplayFor(modelItem => item.Notes)
                            </div>
                        </td>
                        <td class="d-none d-lg-table-cell">@Html.DisplayFor(modelItem => item.ReportsToNavigation.EmployeeId)</td>
                        <td>
                            <div class="btn-group" role="group" aria-label="Basic example">
                                <a asp-action="Edit" asp-route-id="@item.EmployeeId" class="btn btn-sm btn-outline-secondary">Edit</a>
                                <a asp-action="Details" asp-route-id="@item.EmployeeId" class="btn btn-sm btn-outline-info">Details</a>
                                <a asp-action="Delete" asp-route-id="@item.EmployeeId" class="btn btn-sm btn-outline-danger">Delete</a>
                            </div>
                            
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}


@foreach (var item in Model.Where(e => e.Photo != null))
{
    <div class="modal fade" id="photoModal_@item.EmployeeId" tabindex="-1" role="dialog" aria-labelledby="PhotoModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="PhotoModalLabel">@item.FirstName @item.LastName</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">
                    <img src="@Url.Action("GetEmployeePhoto", "Employees", new { id = item.EmployeeId })"
                         alt="Employee Photo"
                         class="img-fluid">
                </div>
            </div>
        </div>
    </div>
}

@section Scripts {
    <script>
        function toggleNotesVisibility(employeeId) {
            var notes = document.getElementById('notes-' + employeeId);
            var isDisplayed = notes.style.display === 'block';
            notes.style.display = isDisplayed ? 'none' : 'block';
        }
    </script>
}







